<div class="meeting-list-container">
  <div class="header">
    <h1>Meeting Summaries</h1>
    <button class="btn btn-primary" (click)="navigateToCreate()">
      <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M440-440H200v-80h240v-240h80v240h240v80H520v240h-80v-240Z"/></svg>
      Neues Meeting erstellen
    </button>
  </div>

  @if (errorMessage()) {
    <div class="error-message fade-in">
      <strong><svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px" fill="#1e293b"><path d="M479.79-288q15.21 0 25.71-10.29t10.5-25.5q0-15.21-10.29-25.71t-25.5-10.5q-15.21 0-25.71 10.29t-10.5 25.5q0 15.21 10.29 25.71t25.5 10.5ZM444-432h72v-240h-72v240Zm36.28 336Q401-96 331-126t-122.5-82.5Q156-261 126-330.96t-30-149.5Q96-560 126-629.5q30-69.5 82.5-122T330.96-834q69.96-30 149.5-30t149.04 30q69.5 30 122 82.5T834-629.28q30 69.73 30 149Q864-401 834-331t-82.5 122.5Q699-156 629.28-126q-69.73 30-149 30Zm-.28-72q130 0 221-91t91-221q0-130-91-221t-221-91q-130 0-221 91t-91 221q0 130 91 221t221 91Zm0-312Z"/></svg>
      Fehler:</strong> {{ errorMessage() }}
    </div>
  }

  @if (isLoading()) {
    <div class="loading-spinner">
      <div class="spinner"></div>
      <p>Meetings werden geladen...</p>
    </div>
  }

  @if (!isLoading() && meetings().length === 0 && !errorMessage()) {
    <div class="empty-state fade-in">
      <p>Noch keine Meetings vorhanden.</p>
    </div>
  }

  @if (!isLoading() && meetings().length > 0) {
    <div class="meetings-table fade-in">
      <table class="table">
        <thead>
          <tr>
            <th>Titel</th>
            <th>Erstellt am</th>
            <th>Status</th>
            <th>Aktionen</th>
          </tr>
        </thead>
        <tbody>
          @for (meeting of meetings(); track trackByMeetingId($index, meeting)) {
            <tr>
              <td class="title-cell" data-label="Titel">
                <strong>{{ meeting.title }}</strong>
              </td>
              <td data-label="Erstellt am">{{ formatDate(meeting.created_at) }}</td>
              <td data-label="Status">
                <span class="status-badge" [class]="getStatusClass(meeting.status)">
                  @if (meeting.status === 'processing') {
                    <span><svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="14px" fill="currentColor"><path d="M324-168h312v-120q0-65-45.5-110.5T480-444q-65 0-110.5 45.5T324-288v120Zm156-348q65 0 110.5-45.5T636-672v-120H324v120q0 65 45.5 110.5T480-516ZM192-96v-72h60v-120q0-59 28-109.5t78-82.5q-49-32-77.5-82.5T252-672v-120h-60v-72h576v72h-60v120q0 59-28.5 109.5T602-480q50 32 78 82.5T708-288v120h60v72H192Z"/></svg></span>
                  }
                  @if (meeting.status === 'completed') {
                    <span><svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="14px" fill="currentColor"><path d="M400-304 240-464l56-56 104 104 264-264 56 56-320 320Z"/></svg></span>
                  }
                  @if (meeting.status === 'failed') {
                    <span><svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="14px" fill="currentColor"><path d="M479.79-288q15.21 0 25.71-10.29t10.5-25.5q0-15.21-10.29-25.71t-25.5-10.5q-15.21 0-25.71 10.29t-10.5 25.5q0 15.21 10.29 25.71t25.5 10.5ZM444-432h72v-240h-72v240Zm36.28 336Q401-96 331-126t-122.5-82.5Q156-261 126-330.96t-30-149.5Q96-560 126-629.5q30-69.5 82.5-122T330.96-834q69.96-30 149.5-30t149.04 30q69.5 30 122 82.5T834-629.28q30 69.73 30 149Q864-401 834-331t-82.5 122.5Q699-156 629.28-126q-69.73 30-149 30Zm-.28-72q130 0 221-91t91-221q0-130-91-221t-221-91q-130 0-221 91t-91 221q0 130 91 221t221 91Zm0-312Z"/></svg></span>
                  }
                  {{ getStatusText(meeting.status) }}
                </span>
              </td>
              <td class="actions-cell" data-label="Aktionen">
                <button
                  class="btn btn-secondary"
                  (click)="navigateToDetail(meeting.id)"
                  >
                  <svg xmlns="http://www.w3.org/2000/svg" height="14px" viewBox="0 -960 960 960" width="20px" fill="#1e293b"><path d="M480-312q70 0 119-49t49-119q0-70-49-119t-119-49q-70 0-119 49t-49 119q0 70 49 119t119 49Zm0-72q-40 0-68-28t-28-68q0-40 28-68t68-28q40 0 68 28t28 68q0 40-28 68t-68 28Zm0 192q-142.6 0-259.8-78.5Q103-349 48-480q55-131 172.2-209.5Q337.4-768 480-768q142.6 0 259.8 78.5Q857-611 912-480q-55 131-172.2 209.5Q622.6-192 480-192Zm0-288Zm0 216q112 0 207-58t146-158q-51-100-146-158t-207-58q-112 0-207 58T127-480q51 100 146 158t207 58Z"/></svg>
                  Anzeigen
                </button>
                <button
                  class="btn btn-danger"
                  (click)="deleteMeeting(meeting.id, meeting.title)">
                  <svg xmlns="http://www.w3.org/2000/svg" height="14px" viewBox="0 -960 960 960" width="14px" fill="#fff"><path d="M312-144q-29.7 0-50.85-21.15Q240-186.3 240-216v-480h-48v-72h192v-48h192v48h192v72h-48v479.57Q720-186 698.85-165T648-144H312Zm336-552H312v480h336v-480ZM384-288h72v-336h-72v336Zm120 0h72v-336h-72v336ZM312-696v480-480Z"/></svg>
                  Meeting l√∂schen
                </button>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</div>
